---
title: 从源程序到目标程序
date: 2020-09-27 9：58
tags: 
- 计算机系统
---

以C语言作为例子来理解。
C语言用编辑器编辑保存的是要给.c文件(文件后缀为.c)，.c文件程序是以字节序列的方式存储在文件中的，每个字节对应一个整数值(ASCII码数)，*例如``` #include <stdio.h>``` 存储在c文件中就是
35(#) 105(i) 110(n) 99(c) 108(l) 117(u) 100(d) 32(SP/空格) 60(<) 115(s) 116(t) 100(d) 105(i) 111(c) 45(.) h(104) 62(>) 10(\n)*

>像.c文件这样只有ASCII字符构成的文件成为文本文件，所有其他文件都成为二进制文件。
![](fanyi.png)
1. 预处理阶段。预处理器（cpp）根据以字符#开头的的命令，修改源程序。 例如```#include<stdio.h>```高速预处理器读取系统头文件stdio.h的内容，把它插入到程序文本中。结果得到了另一个C程序，以.i结尾。
2. 编译阶段。编译器(ccl)将文本文件hello.i文件翻译成文本文件hello.s,它包含一个汇编语言程序。
3. 汇编阶段。汇编器(as)将hello.s翻译成机器语言指令,把汇编指令打包成一种叫做可重定位目标程序的格式.并将结果保存在hello.o文件当中(hello.o是要给二进制文件),此时如果在编辑器中打开hello.o文件,看到的将是一堆乱码(已经不是ASCII码)。
4. 链接阶段。由于在编写hello.c文件的时候用到了printf函数,printf函数是每个C编译器都提供的标准C库中的一个函数,存在于一个printf.o的文件中(已经预编译好了),于是链接器(ld)就将printf.o合并到hello.o程序当中.最后就得到了一个可执行目标文件。